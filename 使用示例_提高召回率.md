# DiariZen æé«˜å¤šäººæ£€æµ‹å¬å›ç‡ - ä½¿ç”¨ç¤ºä¾‹

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ä½¿ç”¨é»˜è®¤å‚æ•°ï¼ˆåŸºçº¿ï¼‰

```bash
python batch_diarize_with_vad_preprocessing.py \
    --original-audio-dir /path/to/original_audios \
    --denoised-audio-dir /path/to/denoised_audios \
    --out-dir /path/to/output
```

### 2. æé«˜å¬å›ç‡ - æ¿€è¿›è®¾ç½®

**ç›®æ ‡**ï¼šæœ€å¤§åŒ–å¤šäººæ£€æµ‹å¬å›ç‡ï¼ˆå¯èƒ½å¢åŠ ä¸€äº›è¯¯æ£€ï¼‰

```bash
python batch_diarize_with_vad_preprocessing.py \
    --original-audio-dir /path/to/original_audios \
    --denoised-audio-dir /path/to/denoised_audios \
    --out-dir /path/to/output \
    --binarize-onset 0.3 \
    --binarize-offset 0.3
```

**å‚æ•°è¯´æ˜**ï¼š
- `--binarize-onset 0.3`ï¼šé™ä½å¼€å¯é˜ˆå€¼ï¼Œæ›´æ•æ„Ÿåœ°æ£€æµ‹è¯´è¯äºº
- `--binarize-offset 0.3`ï¼šé™ä½å…³é—­é˜ˆå€¼ï¼Œä¿æŒè¯´è¯äººæ£€æµ‹

### 3. æé«˜å¬å›ç‡ - å¹³è¡¡è®¾ç½®

**ç›®æ ‡**ï¼šåœ¨å¬å›ç‡å’Œç²¾åº¦ä¹‹é—´å–å¾—å¹³è¡¡

```bash
python batch_diarize_with_vad_preprocessing.py \
    --original-audio-dir /path/to/original_audios \
    --denoised-audio-dir /path/to/denoised_audios \
    --out-dir /path/to/output \
    --binarize-onset 0.4 \
    --binarize-offset 0.4
```

### 4. ä¿å®ˆè®¾ç½®ï¼ˆæé«˜ç²¾åº¦ï¼Œé™ä½å¬å›ç‡ï¼‰

**ç›®æ ‡**ï¼šå‡å°‘è¯¯æ£€ï¼Œä½†å¯èƒ½æ¼æ£€ä¸€äº›è¯´è¯äºº

```bash
python batch_diarize_with_vad_preprocessing.py \
    --original-audio-dir /path/to/original_audios \
    --denoised-audio-dir /path/to/denoised_audios \
    --out-dir /path/to/output \
    --binarize-onset 0.6 \
    --binarize-offset 0.6
```

## ğŸ“Š å‚æ•°è°ƒä¼˜æŒ‡å—

### Binarizeå‚æ•°è¯´æ˜

| å‚æ•° | é»˜è®¤å€¼ | æ¨èèŒƒå›´ | å½±å“ |
|------|--------|----------|------|
| `--binarize-onset` | 0.5 | 0.3-0.6 | å¼€å¯é˜ˆå€¼ï¼Œè¶Šä½è¶Šæ•æ„Ÿ |
| `--binarize-offset` | 0.5 | 0.3-0.6 | å…³é—­é˜ˆå€¼ï¼Œé€šå¸¸ç­‰äºonset |
| `--binarize-min-duration-on` | 0.0 | 0.0-0.1 | æœ€å°è¯­éŸ³æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰ |
| `--binarize-min-duration-off` | 0.0 | 0.0-0.1 | æœ€å°é™éŸ³æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰ |

### ä¸åŒåœºæ™¯çš„æ¨èè®¾ç½®

#### ä¼šè®®åœºæ™¯ï¼ˆå¤šäººå¯¹è¯ï¼Œéœ€è¦é«˜å¬å›ç‡ï¼‰

```bash
python batch_diarize_with_vad_preprocessing.py \
    --original-audio-dir /path/to/original_audios \
    --denoised-audio-dir /path/to/denoised_audios \
    --out-dir /path/to/output \
    --binarize-onset 0.35 \
    --binarize-offset 0.35
```

#### å¯¹è¯åœºæ™¯ï¼ˆ2-3äººï¼Œå¹³è¡¡è®¾ç½®ï¼‰

```bash
python batch_diarize_with_vad_preprocessing.py \
    --original-audio-dir /path/to/original_audios \
    --denoised-audio-dir /path/to/denoised_audios \
    --out-dir /path/to/output \
    --binarize-onset 0.45 \
    --binarize-offset 0.45
```

#### æ’­å®¢åœºæ™¯ï¼ˆéœ€è¦é«˜ç²¾åº¦ï¼Œå‡å°‘è¯¯æ£€ï¼‰

```bash
python batch_diarize_with_vad_preprocessing.py \
    --original-audio-dir /path/to/original_audios \
    --denoised-audio-dir /path/to/denoised_audios \
    --out-dir /path/to/output \
    --binarize-onset 0.55 \
    --binarize-offset 0.55
```

## ğŸ” æ•ˆæœéªŒè¯

### 1. å¯¹æ¯”æµ‹è¯•

ä½¿ç”¨ä¸åŒå‚æ•°å¤„ç†åŒä¸€æ‰¹éŸ³é¢‘ï¼Œå¯¹æ¯”æ£€æµ‹åˆ°çš„è¯´è¯äººæ•°é‡ï¼š

```bash
# åŸºçº¿æµ‹è¯•
python batch_diarize_with_vad_preprocessing.py \
    --original-audio-dir /path/to/original_audios \
    --denoised-audio-dir /path/to/denoised_audios \
    --out-dir /path/to/output_baseline

# é«˜å¬å›ç‡æµ‹è¯•
python batch_diarize_with_vad_preprocessing.py \
    --original-audio-dir /path/to/original_audios \
    --denoised-audio-dir /path/to/denoised_audios \
    --out-dir /path/to/output_high_recall \
    --binarize-onset 0.3 \
    --binarize-offset 0.3
```

### 2. æŸ¥çœ‹ç»“æœç»Ÿè®¡

å¤„ç†å®Œæˆåï¼ŒæŸ¥çœ‹JSONæ±‡æ€»æ–‡ä»¶ä¸­çš„ç»Ÿè®¡ä¿¡æ¯ï¼š

```python
import json

with open('/path/to/output/DiariZen_diar_summary.json', 'r') as f:
    summary = json.load(f)

# ç»Ÿè®¡è¯´è¯äººæ•°é‡åˆ†å¸ƒ
speaker_counts = [item['num_speakers'] for item in summary['items']]
multispeaker_count = sum(1 for item in summary['items'] if item['is_multispeaker'])

print(f"å¹³å‡è¯´è¯äººæ•°: {sum(speaker_counts) / len(speaker_counts):.2f}")
print(f"å¤šè¯´è¯äººéŸ³é¢‘æ•°: {multispeaker_count} / {len(summary['items'])}")
print(f"æœ€å¤§è¯´è¯äººæ•°: {max(speaker_counts)}")
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¬å›ç‡ vs ç²¾åº¦æƒè¡¡**ï¼š
   - é™ä½é˜ˆå€¼ï¼ˆå¦‚0.3ï¼‰â†’ æ›´é«˜å¬å›ç‡ï¼Œä½†å¯èƒ½å¢åŠ è¯¯æ£€
   - æé«˜é˜ˆå€¼ï¼ˆå¦‚0.6ï¼‰â†’ æ›´é«˜ç²¾åº¦ï¼Œä½†å¯èƒ½æ¼æ£€è¯´è¯äºº

2. **å‚æ•°ç»„åˆ**ï¼š
   - å»ºè®®onsetå’Œoffsetä½¿ç”¨ç›¸åŒå€¼
   - å¦‚æœonset < offsetï¼Œä¼šå¯¼è‡´æ£€æµ‹ä¸ç¨³å®š

3. **åœºæ™¯é€‚é…**ï¼š
   - ä¸åŒåœºæ™¯éœ€è¦ä¸åŒå‚æ•°
   - å»ºè®®åœ¨éªŒè¯é›†ä¸Šæµ‹è¯•æ‰¾åˆ°æœ€ä¼˜å‚æ•°

4. **å…¶ä»–ä¼˜åŒ–**ï¼š
   - é™¤äº†Binarizeé˜ˆå€¼ï¼Œè¿˜å¯ä»¥é€šè¿‡è°ƒæ•´èšç±»å‚æ•°è¿›ä¸€æ­¥æé«˜å¬å›ç‡
   - å‚è€ƒ`æé«˜å¤šäººæ£€æµ‹å¬å›ç‡æ–¹æ¡ˆ.md`äº†è§£å®Œæ•´çš„ä¼˜åŒ–ç­–ç•¥

## ğŸ“ å®Œæ•´å‚æ•°åˆ—è¡¨

```bash
python batch_diarize_with_vad_preprocessing.py \
    --original-audio-dir /path/to/original_audios \
    --denoised-audio-dir /path/to/denoised_audios \
    --out-dir /path/to/output \
    --binarize-onset 0.4 \
    --binarize-offset 0.4 \
    --binarize-min-duration-on 0.0 \
    --binarize-min-duration-off 0.0 \
    --vad-threshold 0.5 \
    --vad-min-speech-ms 200.0 \
    --vad-max-silence-ms 300.0 \
    --device cpu \
    --model large
```

## ğŸ”— ç›¸å…³æ–‡æ¡£

- `æé«˜å¤šäººæ£€æµ‹å¬å›ç‡æ–¹æ¡ˆ.md`ï¼šè¯¦ç»†çš„ä¼˜åŒ–ç­–ç•¥å’ŒåŸç†è¯´æ˜
- `DiariZenæŠ€æœ¯æ–‡æ¡£.md`ï¼šå®Œæ•´çš„æŠ€æœ¯æ–‡æ¡£

